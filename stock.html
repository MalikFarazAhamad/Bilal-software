
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Stock Summary - Material Shop</title>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:Arial;
}
body{
  background:#f8fafc;
}
nav{
  background:#0f172a;
  padding:12px;
  text-align:center;
  border-radius:10px;
}
nav a{
  color:#fff;
  text-decoration:none;
  margin:0 8px;
  padding:6px 14px;
  background:#334155;
  border-radius:20px;
}
nav a:hover{
  background:#38bdf8;
  color:#0f172a;
}
.container{
  max-width:1200px; /* BOX INCREASED */
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:15px;
  box-shadow:0 5px 15px rgba(0,0,0,0.1);
}
h2{
  text-align:center;
  margin-bottom:15px;
}

.stock-row{
  display:flex;
  gap:8px;
  margin-bottom:8px;
  flex-wrap:wrap;
}
.stock-row input{
  flex:1;
  min-width:180px;
  padding:8px;
  border-radius:8px;
  border:1px solid #cbd5e1;
}
.stock-row button{
  padding:8px 12px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

.save-btn{
  background:#0f172a;
  color:#fff;
}
.reset-btn{
  background:#dc2626;
  color:#fff;
}
.save-btn:hover{background:#38bdf8;color:#0f172a;}
.reset-btn:hover{background:#ef4444;}

.big-btn{
  width:100%;
  padding:10px;
  margin-top:10px;
  font-size:16px;
  border:none;
  border-radius:10px;
  cursor:pointer;
}
.save-all{
  background:#16a34a;
  color:#fff;
}
.reset-all{
  background:#dc2626;
  color:#fff;
}

.stock-display{
  margin-top:20px;
  padding:15px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
  overflow-x:auto; /* TABLE FIX */
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:13px; /* TABLE SMALL */
}
th,td{
  border:1px solid #cbd5e1;
  padding:8px;
  text-align:center;
}
th{
  background:#0f172a;
  color:#fff;
}
.unavailable{
  color:red;
  font-weight:bold;
}
</style>
</head>

<body>

<nav>
  <a href="index.html">Dashboard</a>
  <a href="prices.html">Prices</a>
  <a href="stock.html">Stock</a>
  <a href="billing.html">Billing</a>
</nav>

<div class="container">
  <h2>Stock Summary</h2>

  <div id="stockInputs"></div>

  <!-- SAVE ALL -->
  <button class="big-btn save-all" onclick="saveAllStock()">Save All Stock</button>

  <!-- RESET ALL -->
  <button class="big-btn reset-all" onclick="resetAllStock()">Reset All Stock</button>

  <div class="stock-display" id="stockView"></div>
</div>

<script>
const items = {
  dg:"DG Cement",
  ml:"Maple Leaf",
  fp:"Flying Pakistan",
  mlw:"Maple Leaf White",
  s4:"Saria 4 CC",
  s3:"Saria 3 CC",
  s2:"Saria 2",
  s6:"Saria 6",
  sl4:"Saria Local 4",
  sl3:"Saria Local 3",
  sg:"Small Gravel",
  lg:"Large Gravel"
};

// LOAD INPUTS
window.onload=()=>{
  for(let k in items){
    stockInputs.innerHTML+=`
      <label><b>${items[k]}</b></label>
      <div class="stock-row">
        <input type="number" id="s_${k}" placeholder="Add Stock" min="0">
        <button class="save-btn" onclick="saveSingle('${k}')">Save</button>
        <button class="reset-btn" onclick="resetSingle('${k}')">Reset</button>
      </div>
    `;
  }
  showStock();
};

// SAVE SINGLE
function saveSingle(k){
  let i=document.getElementById("s_"+k);
  let v=+i.value;
  if(!v) return;
  localStorage.setItem(k,(+localStorage.getItem(k)||0)+v);
  i.value="";
  showStock();
}

// SAVE ALL
function saveAllStock(){
  for(let k in items){
    let i=document.getElementById("s_"+k);
    let v=+i.value;
    if(v){
      localStorage.setItem(k,(+localStorage.getItem(k)||0)+v);
      i.value="";
    }
  }
  showStock();
}

// RESET SINGLE
function resetSingle(k){
  if(!confirm(`Reset ${items[k]} stock?`))return;
  localStorage.removeItem(k);
  localStorage.removeItem(k+"_sold");
  showStock();
}

// RESET ALL
function resetAllStock(){
  if(!confirm("Reset ALL stock?"))return;
  for(let k in items){
    localStorage.removeItem(k);
    localStorage.removeItem(k+"_sold");
  }
  showStock();
}

// SHOW TABLE
function showStock(){
  let keys=Object.keys(items);
  let names=Object.values(items);

  let t=keys.map(k=>+localStorage.getItem(k)||0);
  let s=keys.map(k=>+localStorage.getItem(k+"_sold")||0);
  let a=t.map((v,i)=>v-s[i]);

  let h="<table><tr><th></th>";
  names.forEach(n=>h+=`<th>${n}</th>`);
  h+="</tr>";

  h+="<tr><td>Total</td>";
  t.forEach(v=>h+=`<td>${v}</td>`);
  h+="</tr>";

  h+="<tr><td>Sold</td>";
  s.forEach(v=>h+=`<td>${v}</td>`);
  h+="</tr>";

  h+="<tr><td>Available</td>";
  a.forEach(v=>h+=`<td>${v<=0?'<span class="unavailable">0</span>':v}</td>`);
  h+="</tr></table>";

  stockView.innerHTML=h;
}

// FOR BILLING
function updateSoldStock(k,q){
  localStorage.setItem(k+"_sold",(+localStorage.getItem(k+"_sold")||0)+q);
  showStock();
}
</script>

</body>
</html>
